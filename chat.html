<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>LocalVault — AI Assistant</title>
<meta name="theme-color" content="#0b0d12" />
<style>
  :root{
    --bg:#0b0d12; --panel:#111522; --panel-2:#0e1320;
    --accent:#2f6dff; --accent-2:#8ec5ff; --text:#e8edf6; --muted:#9aa7bd;
    --border:rgba(255,255,255,0.08); --input:#0c101a;
    --shadow:0 10px 30px rgba(0,0,0,.35), 0 1px 0 rgba(255,255,255,.03) inset;
    --radius:16px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text);
    font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
    background:
      radial-gradient(1400px 900px at 75% -15%, rgba(46,109,255,.18) 0%, rgba(46,109,255,0) 55%) fixed no-repeat,
      radial-gradient(1400px 900px at 20% -20%, rgba(142,197,255,.12) 0%, rgba(142,197,255,0) 50%) fixed no-repeat,
      var(--bg);
    background-size: cover,cover,cover;
    min-height:100vh;
  }
  .wrap{max-width:980px; margin:24px auto; padding:0 16px;}
  header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:14px;}
  .brand{display:flex; align-items:center; gap:10px;}
  .brand .logo{width:28px; height:28px}
  .brand .name{font-weight:800; letter-spacing:.3px}
  .brand .tag{font-size:12px; color:var(--muted)}
  .card{background:linear-gradient(180deg, rgba(255,255,255,.025), rgba(255,255,255,.01)); border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow);}
  .toolbar{display:flex; gap:10px; align-items:center; flex-wrap:wrap; padding:10px 12px;}
  .toolbar .right{margin-left:auto; display:flex; gap:8px; align-items:center}
  .chip{border:1px solid var(--border); padding:6px 10px; border-radius:999px; background:var(--panel-2); font-size:12px}
  .muted{color:var(--muted)} .small{font-size:12px}
  .switch-row{display:flex; gap:8px; align-items:center}

  /* CHAT AREA */
  .chat{
    display:flex; flex-direction:column; gap:10px;
    padding:12px; min-height:60vh; max-height:74vh; overflow:auto;
  }
  .msg{display:flex; gap:10px; align-items:flex-start; width:100%}
  .msg.ai{justify-content:flex-start;}     /* assistant on the LEFT   */
  .msg.me{justify-content:flex-end;}       /* user on the RIGHT       */
  .msg.sys{justify-content:center; opacity:.9}

  .bubble{
    padding:10px 12px; border-radius:14px; border:1px solid var(--border);
    max-width:80%; white-space:pre-wrap; word-wrap:break-word;
    background:var(--panel-2);
  }
  .ai .bubble{
    background:#0f1629;              /* left bubble */
    border-top-left-radius:8px;       /* subtle opposite corner */
  }
  .me .bubble{
    background:linear-gradient(180deg,var(--accent),#1f55e8);
    color:#fff; border-color:transparent;
    border-top-right-radius:8px;
  }
  /* Optional tiny “tail” illusion */
  .ai .bubble{ margin-right:auto }
  .me .bubble{ margin-left:auto; text-align:left }

  .compose{display:flex; gap:10px; padding:12px; border-top:1px solid var(--border);}
  textarea{
    flex:1; min-height:42px; max-height:160px; resize:vertical;
    border:1px solid var(--border); border-radius:12px; padding:10px 12px;
    background:var(--input); color:var(--text); outline:none; box-shadow:var(--shadow);
  }
  .btn{
    appearance:none; border:1px solid var(--border); color:var(--text);
    background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,0));
    padding:10px 12px; border-radius:12px; cursor:pointer; box-shadow:var(--shadow);
  }
  .btn.primary{background:linear-gradient(180deg,var(--accent),#1f55e8); color:white; border-color:transparent}
  .btn:disabled{opacity:.6; cursor:not-allowed}
</style>

<!-- Unified blue shield favicon -->
<link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><linearGradient id="g" x1="4" y1="4" x2="20" y2="20"><stop stop-color="%232f6dff"/><stop offset="1" stop-color="%238ec5ff"/></linearGradient></defs><path d="M12 2l7 3v6c0 5.25-3.5 8.74-7 10-3.5-1.26-7-4.75-7-10V5l7-3z" fill="url(%23g)"/><circle cx="12" cy="11.1" r="2" fill="%230b0d12"/><rect x="11.25" y="13.1" width="1.5" height="3" rx=".75" fill="%230b0d12"/></svg>'>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <svg class="logo" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <defs><linearGradient id="lvb" x1="4" y1="4" x2="20" y2="20"><stop stop-color="#2f6dff"/><stop offset="1" stop-color="#8ec5ff"/></linearGradient></defs>
        <path d="M12 2l7 3v6c0 5.25-3.5 8.74-7 10-3.5-1.26-7-4.75-7-10V5l7-3z" fill="url(#lvb)"/>
        <circle cx="12" cy="11.1" r="2" fill="#0b0d12"/><rect x="11.25" y="13.1" width="1.5" height="3" rx=".75" fill="#0b0d12"/>
        </svg>
        <div>
          <div class="name">LocalVault</div>
          <div class="tag muted small">Private. Local. Fast.</div>
        </div>
      </div>
      <div class="right">
        <span id="dataChip" class="chip muted">Detecting data…</span>
        <a href="index.html" class="btn">Back to app</a>
      </div>
    </header>

    <div class="card">
      <div class="toolbar">
        <div class="switch-row">
          <input id="shareToggle" type="checkbox" checked>
          <label for="shareToggle">Include my LocalVault data (banks, assets, ISA, etc.)</label>
        </div>
        <div class="right">
          <button id="clearBtn" class="btn">Clear chat</button>
        </div>
      </div>

      <div id="chat" class="chat" aria-live="polite"></div>

      <div class="compose">
        <textarea id="input" placeholder="Ask about budgeting, subscriptions, ISA math, or anything in your finances.  Shift+Enter = new line"></textarea>
        <button id="send" class="btn primary">Send</button>
      </div>
    </div>

    <div class="small muted" style="margin-top:10px">
      Data is read from your browser’s LocalVault storage and, if enabled, sent with your message to the AI for this session only.
    </div>
  </div>

  <!-- Frontend UI -->
  <script src="/chat.js?v=5" defer></script>
</body>
</html>
